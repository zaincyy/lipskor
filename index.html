<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Livescore Pencak Silat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .hidden { display: none; }
        .loader {
            border: 4px solid #f3f3f3;
            border-radius: 50%;
            border-top: 4px solid #3498db;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <!-- Main Container -->
    <div id="app-container" class="container mx-auto p-4 max-w-7xl">

        <!-- Header -->
        <div id="app-header" class="flex justify-between items-center mb-6 hidden">
            <h1 class="text-2xl font-bold text-cyan-400">Portal Livescore</h1>
            <div>
                <span id="user-email" class="mr-4"></span>
                <span id="user-role-display" class="text-xs bg-cyan-500 text-black font-bold py-1 px-2 rounded-full"></span>
                <button id="logout-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">Logout</button>
            </div>
        </div>

        <!-- Login / Register View -->
        <div id="auth-view" class="max-w-md mx-auto mt-20 p-8 bg-gray-800 rounded-xl shadow-2xl hidden">
            <h2 id="auth-title" class="text-3xl font-bold text-center mb-8 text-white">Login</h2>
            <div id="auth-error" class="text-red-400 mb-4 text-center"></div>
            <form id="auth-form">
                <div class="mb-4">
                    <label for="email" class="block text-gray-300 mb-2">Email</label>
                    <input type="email" id="email" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-cyan-400" required>
                </div>
                <div class="mb-6">
                    <label for="password" class="block text-gray-300 mb-2">Password</label>
                    <input type="password" id="password" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-cyan-400" required>
                </div>
                <button type="submit" id="auth-submit-btn" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 flex items-center justify-center" disabled>
                    <span id="auth-btn-text">Memuat...</span>
                    <div id="auth-loader" class="loader ml-3"></div>
                </button>
            </form>
            <p class="text-center mt-6 text-gray-400">
                <a href="#" id="toggle-auth-mode" class="text-cyan-400 hover:underline">Belum punya akun? Daftar sekarang</a>
            </p>
        </div>

        <!-- Dashboard View -->
        <div id="dashboard-view" class="hidden"></div>

        <!-- Livescore Public View -->
        <div id="livescore-view" class="hidden p-4 md:p-6 bg-black rounded-lg">
             <div class="w-full max-w-5xl mx-auto">
                <div id="marquee-container" class="bg-gray-800 text-center py-2 mb-4 rounded-lg">
                    <p id="marquee-text" class="text-yellow-400 font-bold text-lg animate-pulse">SELAMAT BERTANDING</p>
                </div>
                <div class="grid grid-cols-11 gap-2">
                    <div class="col-span-5 bg-red-600 p-4 rounded-lg border-4 border-white"><div class="text-center"><h2 id="red-perguruan" class="text-xl md:text-3xl font-bold">Nama Perguruan</h2><p id="red-pesilat" class="text-lg md:text-2xl">Nama Pesilat</p></div></div>
                    <div class="col-span-1 flex items-center justify-center"><span class="text-5xl md:text-7xl font-black">VS</span></div>
                    <div class="col-span-5 bg-blue-600 p-4 rounded-lg border-4 border-white"><div class="text-center"><h2 id="blue-perguruan" class="text-xl md:text-3xl font-bold">Nama Perguruan</h2><p id="blue-pesilat" class="text-lg md:text-2xl">Nama Pesilat</p></div></div>
                </div>
                <div class="grid grid-cols-11 gap-2 mt-2">
                    <div class="col-span-4 space-y-2"><div class="bg-gray-700 p-2 rounded-md text-center"><span class="font-semibold">Binaan:</span> <span id="red-binaan">0</span></div><div class="bg-gray-700 p-2 rounded-md text-center"><span class="font-semibold">Teguran:</span> <span id="red-teguran">0</span></div><div class="bg-gray-700 p-2 rounded-md text-center"><span class="font-semibold">Pelanggaran:</span> <span id="red-pelanggaran">0</span></div></div>
                    <div class="col-span-3 flex items-center justify-around bg-gray-800 p-2 rounded-lg border-2 border-white"><div id="red-score" class="text-5xl md:text-7xl font-black text-red-500">0</div><div class="text-center"><p class="text-xl md:text-2xl font-bold">RONDE</p><p id="ronde-display" class="text-3xl md:text-4xl font-black">1</p></div><div id="blue-score" class="text-5xl md:text-7xl font-black text-blue-500">0</div></div>
                    <div class="col-span-4 space-y-2"><div class="bg-gray-700 p-2 rounded-md text-center"><span class="font-semibold">Binaan:</span> <span id="blue-binaan">0</span></div><div class="bg-gray-700 p-2 rounded-md text-center"><span class="font-semibold">Teguran:</span> <span id="blue-teguran">0</span></div><div class="bg-gray-700 p-2 rounded-md text-center"><span class="font-semibold">Pelanggaran:</span> <span id="blue-pelanggaran">0</span></div></div>
                </div>
                <div class="grid grid-cols-11 gap-2 mt-2">
                    <div class="col-span-5 bg-gray-800 p-3 rounded-lg text-center border-2 border-white"><p class="mb-2 font-semibold">Juri Yang Memberi Nilai:</p><div id="red-juri-display" class="flex justify-center space-x-4 text-xl font-bold"><span>J1</span><span>J2</span><span>J3</span></div></div>
                    <div class="col-span-1"></div>
                    <div class="col-span-5 bg-gray-800 p-3 rounded-lg text-center border-2 border-white"><p class="mb-2 font-semibold">Juri Yang Memberi Nilai:</p><div id="blue-juri-display" class="flex justify-center space-x-4 text-xl font-bold"><span>J1</span><span>J2</span><span>J3</span></div></div>
                </div>
                <div class="mt-4 bg-gray-800 p-4 rounded-lg text-center border-2 border-white"><p class="text-2xl font-bold">TIMER</p><p id="timer-display" class="text-6xl font-black text-yellow-400">02:00</p></div>
                 <div id="winner-announcement" class="hidden mt-4 bg-green-600 p-4 rounded-lg text-center"><p class="text-3xl font-bold">PEMENANG</p><p id="winner-name" class="text-4xl font-black"></p></div>
            </div>
        </div>
        
        <!-- Match Control Panel View -->
        <div id="control-panel-view" class="hidden"></div>

    </div>

    <!-- Modal for Messages -->
    <div id="message-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50">
        <div class="bg-gray-800 rounded-lg p-8 max-w-sm w-full shadow-xl">
            <h3 id="modal-title" class="text-2xl font-bold mb-4 text-white">Pemberitahuan</h3>
            <p id="modal-message" class="text-gray-300 mb-6"></p>
            <button id="modal-close-btn" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg">Tutup</button>
        </div>
    </div>

    <script type="module">var _0x58b61a=_0x323a;(function(_0x30f421,_0x452427){var _0x3b246a=_0x323a,_0x59530c=_0x30f421();while(!![]){try{var _0x4d5d1c=-parseInt(_0x3b246a(0x199))/0x1*(-parseInt(_0x3b246a(0x1d4))/0x2)+parseInt(_0x3b246a(0x1d7))/0x3+-parseInt(_0x3b246a(0x19a))/0x4*(-parseInt(_0x3b246a(0x1e2))/0x5)+-parseInt(_0x3b246a(0x187))/0x6+-parseInt(_0x3b246a(0x189))/0x7*(-parseInt(_0x3b246a(0x1a7))/0x8)+parseInt(_0x3b246a(0x191))/0x9+parseInt(_0x3b246a(0x1d1))/0xa;if(_0x4d5d1c===_0x452427)break;else _0x59530c['push'](_0x59530c['shift']());}catch(_0x54bfd5){_0x59530c['push'](_0x59530c['shift']());}}}(_0x54b1,0xcb211));import{initializeApp as _0x43a466}from'https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js';import{getAuth as _0x273c68,createUserWithEmailAndPassword as _0x1f7422,signInWithEmailAndPassword as _0x5f3f0e,onAuthStateChanged as _0x4c205d,signOut as _0x3c914c}from'https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js';import{getFirestore as _0x30a3f3,doc as _0x4f1774,getDoc as _0x2c253b,setDoc as _0x226e6f,updateDoc as _0x411b30,collection as _0x2d194c,query as _0x4d6194,where as _0x2d5f66,getDocs as _0x16d1f0,onSnapshot as _0x55a99b,addDoc as _0x40b615,serverTimestamp as _0x53957a,arrayUnion as _0x38ca7f}from'https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js';const firebaseConfig={'apiKey':_0x58b61a(0x194),'authDomain':_0x58b61a(0x1a5),'projectId':_0x58b61a(0x195),'storageBucket':_0x58b61a(0x193),'messagingSenderId':_0x58b61a(0x190),'appId':_0x58b61a(0x1d3)},app=_0x43a466(firebaseConfig),auth=_0x273c68(app),db=_0x30a3f3(app);let currentUser=null,currentUserData=null,isRegisterMode=![],matchUnsubscribe=null,presenceInterval=null,timerInterval=null;const appHeader=document['getElementById']('app-header'),authView=document[_0x58b61a(0x1b4)]('auth-view'),dashboardView=document[_0x58b61a(0x1b4)]('dashboard-view'),livescoreView=document[_0x58b61a(0x1b4)](_0x58b61a(0x18c)),controlPanelView=document['getElementById']('control-panel-view'),authTitle=document['getElementById']('auth-title'),authForm=document[_0x58b61a(0x1b4)]('auth-form'),authSubmitBtn=document['getElementById'](_0x58b61a(0x1c3)),authBtnText=document['getElementById']('auth-btn-text'),authLoader=document[_0x58b61a(0x1b4)](_0x58b61a(0x1b1)),toggleAuthModeLink=document['getElementById'](_0x58b61a(0x1c4)),authError=document['getElementById'](_0x58b61a(0x1d5)),userEmailDisplay=document[_0x58b61a(0x1b4)]('user-email'),userRoleDisplay=document[_0x58b61a(0x1b4)](_0x58b61a(0x1c5)),logoutBtn=document[_0x58b61a(0x1b4)]('logout-btn'),messageModal=document['getElementById']('message-modal'),modalTitle=document[_0x58b61a(0x1b4)](_0x58b61a(0x1d6)),modalMessage=document[_0x58b61a(0x1b4)]('modal-message'),modalCloseBtn=document['getElementById'](_0x58b61a(0x18d));function _0x323a(_0x12d27a,_0x403135){_0x12d27a=_0x12d27a-0x187;var _0x54b1c3=_0x54b1[_0x12d27a];return _0x54b1c3;}function showView(_0x1b70d5){var _0x458797=_0x58b61a;[authView,dashboardView,livescoreView,controlPanelView][_0x458797(0x1c8)](_0x433a04=>_0x433a04['classList']['add']('hidden'));const _0x489b82=document[_0x458797(0x1b4)](_0x1b70d5);_0x489b82&&_0x489b82['classList']['remove']('hidden'),_0x1b70d5===_0x458797(0x18c)?appHeader['classList']['add']('hidden'):currentUser&&appHeader[_0x458797(0x1a8)][_0x458797(0x18a)]('hidden');}function showModal(_0x43736d,_0x207f21){var _0x40c883=_0x58b61a;modalTitle[_0x40c883(0x1b5)]=_0x43736d,modalMessage['textContent']=_0x207f21,messageModal[_0x40c883(0x1a8)][_0x40c883(0x18a)]('hidden');}function hideModal(){messageModal['classList']['add']('hidden');}function showAuthLoader(_0x3819d9){var _0x495a3c=_0x58b61a;authSubmitBtn['disabled']=_0x3819d9,authBtnText['classList']['toggle']('hidden',_0x3819d9),authLoader[_0x495a3c(0x1a8)]['toggle']('hidden',!_0x3819d9);}function toggleAuthMode(_0x54182a=!![]){var _0x4d326f=_0x58b61a;isRegisterMode=!isRegisterMode,authTitle[_0x4d326f(0x1b5)]=isRegisterMode?'Daftar\x20Akun\x20Baru':'Login',authBtnText[_0x4d326f(0x1b5)]=isRegisterMode?'Daftar':'Login',toggleAuthModeLink['textContent']=isRegisterMode?'Sudah\x20punya\x20akun?\x20Login':'Belum\x20punya\x20akun?\x20Daftar',authError['textContent']='',_0x54182a&&showAuthLoader(![]);}async function handleAuthSubmit(_0x223594){var _0x46453b=_0x58b61a;_0x223594['preventDefault']();const _0x403d52=document[_0x46453b(0x1b4)]('email')[_0x46453b(0x1b2)],_0x25a3d0=document['getElementById']('password')[_0x46453b(0x1b2)];authError[_0x46453b(0x1b5)]='',showAuthLoader(!![]);try{if(isRegisterMode){const _0x53e7d5=await _0x1f7422(auth,_0x403d52,_0x25a3d0),_0x2a3e03=_0x53e7d5['user'],_0x5d5952=_0x4f1774(db,'users',_0x2a3e03['uid']);await _0x226e6f(_0x5d5952,{'email':_0x2a3e03[_0x46453b(0x1d2)],'role':_0x46453b(0x198),'subscriptionExpiry':null,'createdAt':_0x53957a()}),showModal('Sukses','Pendaftaran\x20berhasil!\x20Anda\x20sekarang\x20bisa\x20login.'),toggleAuthMode();}else await _0x5f3f0e(auth,_0x403d52,_0x25a3d0);}catch(_0x42e057){console['error']('Auth\x20Error:',_0x42e057['code'],_0x42e057['message']),_0x42e057['code']===_0x46453b(0x1da)?authError[_0x46453b(0x1b5)]='Email\x20ini\x20sudah\x20terdaftar.\x20Silakan\x20login.':_0x42e057['code']===_0x46453b(0x1c6)||_0x42e057['code']==='auth/wrong-password'||_0x42e057[_0x46453b(0x1a6)]===_0x46453b(0x1e3)?authError['textContent']='Email\x20tidak\x20terdaftar,\x20atau\x20password\x20salah.':authError[_0x46453b(0x1b5)]=_0x46453b(0x1b8);}finally{showAuthLoader(![]);}}function initializeAppFlow(){var _0x1b3563=_0x58b61a;const _0x1f274a=new URLSearchParams(window['location']['search']),_0x18e1b6=_0x1f274a['get']('match'),_0x529141=_0x1f274a['get'](_0x1b3563(0x1d0));_0x18e1b6&&!_0x529141?renderLivescore(_0x18e1b6):_0x4c205d(auth,handleAuthStateChange);}async function handleAuthStateChange(_0x322b73){var _0x58572d=_0x58b61a;presenceInterval&&clearInterval(presenceInterval),_0x322b73?(async function(){var _0x58c06e=_0x58572d;const _0x57343e=_0x4f1774(db,'users',_0x322b73['uid']),_0x373809=await _0x2c253b(_0x57343e);if(_0x373809['exists']()){currentUser=_0x322b73,currentUserData={'id':_0x322b73['uid'],..._0x373809['data']()};const _0x53d2d2=new URLSearchParams(window['location']['search']),_0x51737e=_0x53d2d2['get'](_0x58c06e(0x1d0));userEmailDisplay[_0x58c06e(0x1b5)]=currentUserData[_0x58c06e(0x1d2)],userRoleDisplay[_0x58c06e(0x1b5)]=currentUserData['role'][_0x58c06e(0x1e0)](),_0x51737e?currentUserData['role']===_0x58c06e(0x198)?await renderPenggunaControlPanel(_0x51737e):await renderOfficialControlPanel(_0x51737e):await renderDashboard(),showView(currentUserData['role']===_0x58c06e(0x198)?'dashboard-view':'control-panel-view');}else console['warn']('User\x20'+_0x322b73['uid']+'\x20exists\x20in\x20Auth\x20but\x20not\x20in\x20Firestore.\x20Signing\x20out.'),await _0x3c914c(auth);}()):(currentUser=null,currentUserData=null,appHeader['classList']['add']('hidden'),matchUnsubscribe&&matchUnsubscribe(),showView('auth-view'),toggleAuthMode(!![]),isRegisterMode&&toggleAuthMode());}async function handlePayment(){var _0x4c754d=_0x58b61a;const _0x3e15f6=document[_0x4c754d(0x1b4)]('pay-btn');_0x3e15f6['disabled']=!![],_0x3e15f6['textContent']='Memproses...';await new Promise(_0x2e061e=>setTimeout(_0x2e061e,0x5dc));try{const _0x231e80=new Date();_0x231e80['setDate'](_0x231e80['getDate']()+0x1);await _0x411b30(_0x4f1774(db,'users',currentUser['uid']),{'subscriptionExpiry':_0x231e80}),showModal('Pembayaran\x20Berhasil','Langganan\x20Anda\x20sekarang\x20aktif\x20selama\x2024\x20jam.'),await renderDashboard();}catch(_0x40d588){showModal('Gagal',_0x4c754d(0x19d)),_0x3e15f6['disabled']=![],_0x3e15f6[_0x4c754d(0x1b5)]=_0x4c754d(0x19c);}}async function renderDashboard(){var _0x4a0121=_0x58b61a;if(!currentUserData)return;const _0x5d0b98=currentUserData['role'];let _0x501b8a='<h2\x20class=\x22text-3xl\x20font-bold\x20mb-6\x22>Dashboard\x20'+_0x5d0b98['charAt'](0x0)[_0x4a0121(0x1e0)]()+_0x5d0b98['slice'](0x1)+'</h2>';switch(_0x5d0b98){case'admin':_0x501b8a+=await getAdminDashboard();break;case _0x4a0121(0x198):_0x501b8a+=await getPenggunaDashboard();break;case'juri':case'dewan':case'ketua':_0x501b8a+=await getOfficialDashboard(_0x5d0b98);break;}dashboardView['innerHTML']=_0x501b8a,attachDashboardEventListeners();}async function getAdminDashboard(){var _0x3a4843=_0x58b61a;const _0x385552=await _0x16d1f0(_0x2d194c(db,'users')),_0x20c9a0=await _0x16d1f0(_0x4d6194(_0x2d194c(db,'matches'),_0x2d5f66('status','==','pending_activation')));let _0x160e34='<div\x20class=\x22bg-gray-800\x20rounded-lg\x20p-4\x20mb-8\x22><h3\x20class=\x22text-xl\x20font-semibold\x20mb-4\x22>Manajemen\x20Pengguna\x20Terdaftar</h3><div\x20class=\x22overflow-x-auto\x22><table\x20class=\x22min-w-full\x22><thead\x20class=\x22bg-gray-700\x22><tr><th\x20class=\x22px-4\x20py-3\x20text-left\x20text-sm\x20font-semibold\x20uppercase\x22>Email</th><th\x20class=\x22px-4\x20py-3\x20text-left\x20text-sm\x20font-semibold\x20uppercase\x22>Role</th><th\x20class=\x22px-4\x20py-3\x20text-left\x20text-sm\x20font-semibold\x20uppercase\x22>Status\x20Pembayaran\x20&\x20Jatuh\x20Tempo</th><th\x20class=\x22px-4\x20py-3\x20text-left\x20text-sm\x20font-semibold\x20uppercase\x22>Aksi</th></tr></thead><tbody>';return _0x385552['forEach'](_0x1e2025=>{var _0x277a06=_0x3a4843;const _0x598971=_0x1e2025['data'](),_0x5d0b98=_0x598971['subscriptionExpiry'],_0x501b8a=_0x5d0b98&&new Date(_0x5d0b98['seconds']*0x3e8)>new Date();let _0x2e061e=_0x598971['role']==='pengguna'?_0x501b8a?'<span\x20class=\x22text-green-400\x20font-semibold\x22>Aktif</span><br><small\x20class=\x22text-gray-400\x22>s/d\x20'+new Date(_0x5d0b98['seconds']*0x3e8)[_0x277a06(0x1e1)]('id-ID')+'</small>':'<span\x20class=\x22text-red-400\x20font-semibold\x22>Tidak\x20Aktif</span>':'<span\x20class=\x22text-gray-500\x22>-</span>';_0x160e34+='<tr\x20class=\x22border-b\x20border-gray-700\x22><td\x20class=\x22px-4\x20py-3\x22>'+_0x598971[_0x277a06(0x1d2)]+'</td><td\x20class=\x22px-4\x20py-3\x22>'+_0x598971['role']+'</td><td\x20class=\x22px-4\x20py-3\x22>'+_0x2e061e+'</td><td\x20class=\x22px-4\x20py-3\x22><select\x20data-userid=\x22'+_0x1e2025['id']+'\x22\x20class=\x22role-selector\x20bg-gray-600\x20rounded\x20p-2\x22><option\x20value=\x22pengguna\x22\x20'+(_0x598971['role']==='pengguna'?'selected':'')+'>Pengguna</option><option\x20value=\x22juri\x22\x20'+(_0x598971['role']==='juri'?'selected':'')+'>Juri</option><option\x20value=\x22dewan\x22\x20'+(_0x598971['role']==='dewan'?'selected':'')+'>Dewan</option><option\x20value=\x22ketua\x22\x20'+(_0x598971['role']==='ketua'?'selected':'')+'>Ketua</option><option\x20value=\x22admin\x22\x20'+(_0x598971['role']==='admin'?'selected':'')+'>Admin</option></select></td></tr>';}),_0x160e34+='</tbody></table></div></div>',_0x160e34;}</script>

</body>
</html>

